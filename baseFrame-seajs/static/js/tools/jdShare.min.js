/*static-0.1.0  2017-06-17 15:40:30*/

!function(a,b){"function"==typeof define&&define.amd?define(function(){return b(a)}):"function"==typeof define&&define.cmd?define(function(){return b(a)}):"undefined"!=typeof module&&module.exports?module.exports=b(a):a.jdShare=b(a)}("undefined"!=typeof window?window:this,function(a){"use strict";function b(a){return'openapp.jdmobile://communication?params={"des":"share","type":"111","title":"'+a.title+'","content":"'+a.content+'","shareUrl":"'+a.url+'","iconUrl":"'+a.img+'","shareActionType":"'+a.shareActionType+'","channel":"'+a.channel+'","timeline_title":"'+a.timeline_title+'","qrparam":"'+a.qrparam+'","callback":"'+a.callbackSwitcher+'","clickcallback":"'+a.clickcallbackSwitcher+'"}'}function c(a){shareHelper.initShare(JSON.stringify({title:a.title,content:a.content,shareUrl:decodeURIComponent(a.url),iconUrl:decodeURIComponent(a.img),shareActionType:a.shareActionType,channel:a.channel,timeline_title:a.timeline_title,"qrpara m":a.qrparam,callback:a.callbackSwitcher,clickcallback:a.clickcallbackSwitcher,eventId:""}))}function d(a,b){shareHelper[a](b.title,b.content,decodeURIComponent(b.url),decodeURIComponent(b.img),b.callbackSwitcher)}function e(a,b){shareHelper[a](b.title,b.content,decodeURIComponent(b.url),decodeURIComponent(b.img))}function f(a,b){return'openapp.jdmobile://communication?params={"action":"'+b+'","title":"'+a.title+'","content":"'+a.content+'","shareUrl":"'+a.url+'","iconUrl":"'+a.img+'","isCallBack":"'+a.callbackSwitcher+'"}'}function g(a){var b={category:"jump",des:"share",type:"111",title:a.title,content:a.content,shareUrl:a.url,imageUrl:a.img,iconUrl:a.img,timeline_title:a.timeline_title,qrparam:a.qrparam,channel:a.channel,isCallBack:a.callbackSwitcher,clickcallback:a.clickcallbackSwitcher,shareActionType:a.shareActionType};return B+"virtual?params="+JSON.stringify(b)}function h(a){if(!(this instanceof h))return new h(a)}function i(a){this.message=a,this.name="JdShareException",this.toString=function(){return this.name+": "+this.message}}function j(a,b){for(var c in b)b.hasOwnProperty(c)&&void 0!==b[c]&&(a[c]=b[c])}function k(a,b){return""==b?a:(a+"&"+b).replace(/[&?]{1,2}/,"?")}function l(b){a.jdappShareRes=function(a){a.hasOwnProperty("shareResult")?b.callback&&b.callback(a):b.clickcallback&&b.clickcallback(a)}}function m(a){var b={Wxfriends:"WeChat_Friend",Wxmoments:"WeChat_FriendTimeline",Sinaweibo:"Weibo",QQfriends:"QQFriend_SHARE_CLIENT",QQzone:"QQZone_SHARE_CLIENT",Moreshare:""},c="";if(a){if(v){if(z){if(c=b[a])return c;throw new i("输入的channel参数在iphone版本中不存在")}return a}return a}return a}function n(a){return void 0!==a.title&&void 0!==a.content&&void 0!==a.url&&void 0!==a.img}function o(a){if(n(a)){try{var b,c,d,e,f={timeline_title:"",channel:"",qrparam:null,callback:null,clickcallback:null};"[object Object]"===Object.prototype.toString.call(a)&&j(f,a),b="function"==typeof f.callback,d="function"==typeof f.clickcallback,c=b?C.WITH_CALLBACK:C.WITHOUT_CALLBACK,e=d?C.WITH_CALLBACK:C.WITHOUT_CALLBACK,b&&d?l({callback:f.callback,clickcallback:f.clickcallback}):b?l({callback:f.callback}):d&&l({clickcallback:f.clickcallback}),"[object Object]"===Object.prototype.toString.call(f.qrparam)&&(f.qrparam.top_pic=f.qrparam.top_pic?encodeURIComponent(decodeURIComponent(f.qrparam.top_pic)):"",f.qrparam.mid_pic=f.qrparam.mid_pic?encodeURIComponent(decodeURIComponent(f.qrparam.mid_pic)):"",f.qrparam.qr_direct=f.qrparam.qr_direct?encodeURIComponent(decodeURIComponent(f.qrparam.qr_direct)):""),f.callbackSwitcher=c,f.clickcallbackSwitcher=e,f.url=k(f.url,"_ts="+(new Date).getTime()),f.channel=m(f.channel),f.url=encodeURIComponent(f.url),f.img=encodeURIComponent(f.img)}catch(a){throw a}return f}throw new i("调用方法时传入配置对象格式错误，请查看文档")}var p,q=navigator.userAgent.toLowerCase(),r=q.split(";"),s=-1!=q.indexOf("jdapp"),t=function(){if(s&&r[2])try{return parseInt(r[2].replace(/\./g,""))}catch(a){}}(),u="android"===r[1],v="iphone"===r[1],w=u||v,x=-1!=q.indexOf("ipad"),y=(/MicroMessenger/i.test(q),w&&s&&t>=500),z=w&&s&&t>=440&&t<500,A=x&&s&&t>=360,B=function(){return w?"openapp.jdmobile://":x?"openapp.jdipad://":void 0}(),C={WITH_CALLBACK:"Y",WITHOUT_CALLBACK:"N",SHARE_ACTION_SET:"S",SHARE_ACTION_PANE:"P",SHARE_ACTION_OPEN:"O"};return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,h.prototype.setShareInfo=function(h){try{var i=null;if(s)if(i=o(h),i.shareActionType=C.SHARE_ACTION_SET,u)if(a.shareHelper)if("function"==typeof shareHelper.initShare)c(i);else if("function"==typeof shareHelper.setShareInfoCallback)if(i.callbackSwitcher===C.WITH_CALLBACK)try{d("setShareInfoCallback",i)}catch(a){e("setShareInfoCallback",i)}else try{d("setShareInfoCallback",i)}catch(a){"function"==typeof shareHelper.setShareInfo&&e("setShareInfo",i)}else"function"==typeof shareHelper.setShareInfo&&e("setShareInfo",i);else a.location.href=b(i);else(v||x)&&(y||A?location.href=g(i):v&&(location.href=f(i,"syncShareData")))}catch(a){throw a}},h.prototype.callSharePane=function(e){try{var h=null;h=o(e),h.shareActionType=C.SHARE_ACTION_PANE,u?s&&a.shareHelper?"function"==typeof shareHelper.initShare?c(h):"function"==typeof shareHelper.callShare?d("callShare",h):a.location.href=b(h):a.location.href=b(h):(v||x)&&(y||A?location.href=g(h):v&&(location.href=f(h,"share")))}catch(a){throw a}},h.prototype.sendDirectShare=function(d){try{var e,f=null;if(f=o(d),f.shareActionType=C.SHARE_ACTION_OPEN,u)s&&a.shareHelper?"function"==typeof shareHelper.initShare?c(f):"function"==typeof shareHelper.sendShare?shareHelper.sendShare(f.title,f.content,decodeURIComponent(f.url),decodeURIComponent(f.img),f.channel,f.callbackSwitcher):location.href=b(f):a.location.href=b(f);else if(v||x){if(!f.channel)throw new i("分享渠道未设置");y||A?location.href=g(f):v&&(e='openapp.jdmobile://virtual?params={"category":"jump","des":"share","type":"111","title":"'+f.title+'","content":"'+f.content+'","shareUrl":"'+f.url+'","imageUrl":"'+f.img+'","channel":"'+f.channel+'","isCallBack":"'+f.callbackSwitcher+'"}',location.href=e)}}catch(a){throw a}},p||(p=h()),p});